<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Babylon.js Playground</title>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>

  <!-- Babylon globals (kept so window.BABYLON is available if your app expects it) -->
  <script src="https://assets.babylonjs.com/generated/Assets.js"></script>
  <script src="https://cdn.babylonjs.com/recast.js"></script>
  <script src="https://cdn.babylonjs.com/ammo.js"></script>
  <script src="https://cdn.babylonjs.com/havok/HavokPhysics_umd.js"></script>
  <script src="https://cdn.babylonjs.com/cannon.js"></script>
  <script src="https://cdn.babylonjs.com/Oimo.js"></script>
  <script src="https://cdn.babylonjs.com/earcut.min.js"></script>
  <script src="https://cdn.babylonjs.com/babylon.js"></script>
  <script src="https://cdn.babylonjs.com/materialsLibrary/babylonjs.materials.min.js"></script>
  <script src="https://cdn.babylonjs.com/proceduralTexturesLibrary/babylonjs.proceduralTextures.min.js"></script>
  <script src="https://cdn.babylonjs.com/postProcessesLibrary/babylonjs.postProcess.min.js"></script>
  <script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.js"></script>
  <script src="https://cdn.babylonjs.com/serializers/babylonjs.serializers.min.js"></script>
  <script src="https://cdn.babylonjs.com/gui/babylon.gui.min.js"></script>
  <script src="https://cdn.babylonjs.com/addons/babylonjs.addons.min.js"></script>
  <script src="https://cdn.babylonjs.com/inspector/babylon.inspector.bundle.js"></script>

  <style>
    html,body,#renderCanvas{width:100%;height:100%;margin:0;padding:0;overflow:hidden;background:#000}
  </style>
</head>
<body>
  <canvas id="renderCanvas"></canvas>
  <script type="module">
    // Turn bundle text into a module URL
    const code = "// snapshot:index.js\nvar createScene = async function() {\n  const canvas = document.getElementById(\"renderCanvas\");\n  const engine = new BABYLON.Engine(canvas, true, { preserveDrawingBuffer: true, stencil: true });\n  const scene = new BABYLON.Scene(engine);\n  new BABYLON.HemisphericLight(\"hemi\", new BABYLON.Vector3(0, 1, 0), scene);\n  const ground = BABYLON.MeshBuilder.CreateGround(\"ground\", { width: 10, height: 10 }, scene);\n  scene.createDefaultCamera(true, false, true);\n  var camera = new BABYLON.ArcRotateCamera(\"camera\", 0, 1, 10, BABYLON.Vector3.Zero(), scene);\n  camera.attachControl(canvas, true);\n  const xr = await scene.createDefaultXRExperienceAsync({\n    uiOptions: { sessionMode: \"immersive-ar\" },\n    optionalFeatures: true\n  });\n  const manager = new BABYLON.GUI.GUI3DManager(scene);\n  const panel3D = new BABYLON.GUI.StackPanel3D();\n  panel3D.margin = 0.03;\n  manager.addControl(panel3D);\n  panel3D.position = new BABYLON.Vector3(0, 1.5, 1.5);\n  function add3DButton(text, onClick) {\n    const btn = new BABYLON.GUI.HolographicButton(\"btn_\" + text);\n    btn.text = text;\n    btn.onPointerUpObservable.add(onClick);\n    panel3D.addControl(btn);\n    return btn;\n  }\n  const ui = BABYLON.GUI.AdvancedDynamicTexture.CreateFullscreenUI(\"hud\", true, scene);\n  const hint = new BABYLON.GUI.TextBlock();\n  hint.text = \"Controls: a = Walk   x = Smile   y = Confuse\";\n  hint.color = \"white\";\n  hint.fontSize = 22;\n  hint.textHorizontalAlignment = BABYLON.GUI.Control.HORIZONTAL_ALIGNMENT_LEFT;\n  hint.textVerticalAlignment = BABYLON.GUI.Control.VERTICAL_ALIGNMENT_TOP;\n  hint.paddingLeft = \"14px\";\n  hint.paddingTop = \"14px\";\n  hint.outlineColor = \"black\";\n  hint.outlineWidth = 4;\n  ui.addControl(hint);\n  const fileInput = document.createElement(\"input\");\n  fileInput.type = \"file\";\n  fileInput.accept = \".glb,.gltf\";\n  fileInput.style.display = \"none\";\n  document.body.appendChild(fileInput);\n  add3DButton(\"\\u{1F4C2} Load GLB/GLTF\", () => fileInput.click());\n  let currentRoot = null;\n  let allGroups = [];\n  let walk = null, smile = null, confused = null;\n  const stopAllFace = () => {\n    if (smile) smile.stop();\n    if (confused) confused.stop();\n  };\n  function pickAnimations() {\n    allGroups = scene.animationGroups || [];\n    const lc = (s) => (s || \"\").toLowerCase();\n    const byName = (key) => allGroups.find((g) => lc(g.name).includes(key));\n    walk = byName(\"walk\") || null;\n    smile = byName(\"smile\") || null;\n    confused = byName(\"confuse\") || null;\n  }\n  function toggleWalk() {\n    if (!walk) return;\n    if (walk.isPlaying) walk.stop();\n    else {\n      walk.reset();\n      walk.start(true, 1);\n    }\n  }\n  function playSmile() {\n    stopAllFace();\n    if (smile) {\n      smile.reset();\n      smile.start(true, 1);\n    }\n  }\n  function playConfused() {\n    stopAllFace();\n    if (confused) {\n      confused.reset();\n      confused.start(true, 1);\n    }\n  }\n  fileInput.addEventListener(\"change\", async (ev) => {\n    const file = ev.target.files?.[0];\n    if (!file) return;\n    scene.meshes.filter((m) => m !== ground).forEach((m) => m.dispose());\n    scene.animationGroups.slice().forEach((g) => g.dispose());\n    walk = smile = confused = null;\n    allGroups = [];\n    currentRoot = null;\n    try {\n      const result = await BABYLON.SceneLoader.AppendAsync(\"file:\", file, scene);\n      currentRoot = result.meshes.find((m) => m && m.name && m !== ground) || result.meshes[0];\n      if (currentRoot?.scaling) currentRoot.scaling.setAll(0.2);\n      pickAnimations();\n    } catch (e) {\n      console.error(\"Load error:\", e);\n    } finally {\n      fileInput.value = \"\";\n    }\n  });\n  const ctrls = { left: null, right: null };\n  xr.input.onControllerAddedObservable.add((c) => {\n    const h = c.inputSource?.handedness;\n    if (h) ctrls[h] = c;\n  });\n  xr.input.onControllerRemovedObservable.add((c) => {\n    const h = c.inputSource?.handedness;\n    if (h && ctrls[h] === c) ctrls[h] = null;\n  });\n  let prev = { A: false, X: false, Y: false };\n  function anyPressed(ctrl, idxs) {\n    if (!ctrl?.inputSource?.gamepad) return false;\n    const bs = ctrl.inputSource.gamepad.buttons || [];\n    for (const i of idxs) {\n      const b = bs[i];\n      if (b && b.pressed) return true;\n    }\n    return false;\n  }\n  scene.onBeforeRenderObservable.add(() => {\n    const A = anyPressed(ctrls.right, [0, 1, 2, 3, 4, 5]);\n    const X = anyPressed(ctrls.left, [0, 3, 4, 5, 1, 2]);\n    const Y = anyPressed(ctrls.left, [1, 4, 5, 3, 0, 2]);\n    if (A && !prev.A) toggleWalk();\n    if (X && !prev.X) playSmile();\n    if (Y && !prev.Y) playConfused();\n    prev = { A, X, Y };\n  });\n  window.addEventListener(\"keydown\", (e) => {\n    const k = e.key.toLowerCase();\n    if (k === \"a\") toggleWalk();\n    if (k === \"x\") playSmile();\n    if (k === \"y\") playConfused();\n  });\n  engine.runRenderLoop(() => scene.render());\n  window.addEventListener(\"resize\", () => engine.resize());\n  return scene;\n};\nexport {\n  createScene\n};\n//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic25hcHNob3Q6aW5kZXguanMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImV4cG9ydCBjb25zdCBjcmVhdGVTY2VuZSA9IGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgY29uc3QgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyZW5kZXJDYW52YXNcIik7XG4gIGNvbnN0IGVuZ2luZSA9IG5ldyBCQUJZTE9OLkVuZ2luZShjYW52YXMsIHRydWUsIHsgcHJlc2VydmVEcmF3aW5nQnVmZmVyOiB0cnVlLCBzdGVuY2lsOiB0cnVlIH0pO1xuICBjb25zdCBzY2VuZSA9IG5ldyBCQUJZTE9OLlNjZW5lKGVuZ2luZSk7XG5cbiAgbmV3IEJBQllMT04uSGVtaXNwaGVyaWNMaWdodChcImhlbWlcIiwgbmV3IEJBQllMT04uVmVjdG9yMygwLCAxLCAwKSwgc2NlbmUpO1xuICBjb25zdCBncm91bmQgPSBCQUJZTE9OLk1lc2hCdWlsZGVyLkNyZWF0ZUdyb3VuZChcImdyb3VuZFwiLCB7IHdpZHRoOiAxMCwgaGVpZ2h0OiAxMCB9LCBzY2VuZSk7XG4gIHNjZW5lLmNyZWF0ZURlZmF1bHRDYW1lcmEodHJ1ZSwgZmFsc2UsIHRydWUpO1xuICB2YXIgY2FtZXJhID0gbmV3IEJBQllMT04uQXJjUm90YXRlQ2FtZXJhKFwiY2FtZXJhXCIsIDAsIDEsIDEwLCBCQUJZTE9OLlZlY3RvcjMuWmVybygpLCBzY2VuZSk7XG4gIGNhbWVyYS5hdHRhY2hDb250cm9sKGNhbnZhcywgdHJ1ZSk7XG4gICBcbiAgY29uc3QgeHIgPSBhd2FpdCBzY2VuZS5jcmVhdGVEZWZhdWx0WFJFeHBlcmllbmNlQXN5bmMoe1xuICAgIHVpT3B0aW9uczogeyBzZXNzaW9uTW9kZTogXCJpbW1lcnNpdmUtYXJcIiB9LFxuICAgIG9wdGlvbmFsRmVhdHVyZXM6IHRydWUsXG4gIH0pO1xuXG4gIGNvbnN0IG1hbmFnZXIgPSBuZXcgQkFCWUxPTi5HVUkuR1VJM0RNYW5hZ2VyKHNjZW5lKTtcbiAgY29uc3QgcGFuZWwzRCA9IG5ldyBCQUJZTE9OLkdVSS5TdGFja1BhbmVsM0QoKTtcbiAgcGFuZWwzRC5tYXJnaW4gPSAwLjAzO1xuICBtYW5hZ2VyLmFkZENvbnRyb2wocGFuZWwzRCk7XG4gIHBhbmVsM0QucG9zaXRpb24gPSBuZXcgQkFCWUxPTi5WZWN0b3IzKDAsIDEuNSwgMS41KTtcblxuICBmdW5jdGlvbiBhZGQzREJ1dHRvbih0ZXh0LCBvbkNsaWNrKSB7XG4gICAgY29uc3QgYnRuID0gbmV3IEJBQllMT04uR1VJLkhvbG9ncmFwaGljQnV0dG9uKFwiYnRuX1wiICsgdGV4dCk7XG4gICAgYnRuLnRleHQgPSB0ZXh0O1xuICAgIGJ0bi5vblBvaW50ZXJVcE9ic2VydmFibGUuYWRkKG9uQ2xpY2spO1xuICAgIHBhbmVsM0QuYWRkQ29udHJvbChidG4pO1xuICAgIHJldHVybiBidG47XG4gIH1cblxuICBjb25zdCB1aSA9IEJBQllMT04uR1VJLkFkdmFuY2VkRHluYW1pY1RleHR1cmUuQ3JlYXRlRnVsbHNjcmVlblVJKFwiaHVkXCIsIHRydWUsIHNjZW5lKTtcbiAgY29uc3QgaGludCA9IG5ldyBCQUJZTE9OLkdVSS5UZXh0QmxvY2soKTtcbiAgaGludC50ZXh0ID0gXCJDb250cm9sczogYSA9IFdhbGsgICB4ID0gU21pbGUgICB5ID0gQ29uZnVzZVwiO1xuICBoaW50LmNvbG9yID0gXCJ3aGl0ZVwiO1xuICBoaW50LmZvbnRTaXplID0gMjI7XG4gIGhpbnQudGV4dEhvcml6b250YWxBbGlnbm1lbnQgPSBCQUJZTE9OLkdVSS5Db250cm9sLkhPUklaT05UQUxfQUxJR05NRU5UX0xFRlQ7XG4gIGhpbnQudGV4dFZlcnRpY2FsQWxpZ25tZW50ID0gQkFCWUxPTi5HVUkuQ29udHJvbC5WRVJUSUNBTF9BTElHTk1FTlRfVE9QO1xuICBoaW50LnBhZGRpbmdMZWZ0ID0gXCIxNHB4XCI7XG4gIGhpbnQucGFkZGluZ1RvcCA9IFwiMTRweFwiO1xuICBoaW50Lm91dGxpbmVDb2xvciA9IFwiYmxhY2tcIjtcbiAgaGludC5vdXRsaW5lV2lkdGggPSA0O1xuICB1aS5hZGRDb250cm9sKGhpbnQpO1xuXG4gIGNvbnN0IGZpbGVJbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcbiAgZmlsZUlucHV0LnR5cGUgPSBcImZpbGVcIjtcbiAgZmlsZUlucHV0LmFjY2VwdCA9IFwiLmdsYiwuZ2x0ZlwiO1xuICBmaWxlSW5wdXQuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGZpbGVJbnB1dCk7XG4gIGFkZDNEQnV0dG9uKFwiXHVEODNEXHVEQ0MyIExvYWQgR0xCL0dMVEZcIiwgKCkgPT4gZmlsZUlucHV0LmNsaWNrKCkpO1xuXG4gIGxldCBjdXJyZW50Um9vdCA9IG51bGw7XG4gIGxldCBhbGxHcm91cHMgPSBbXTtcbiAgbGV0IHdhbGsgPSBudWxsLCBzbWlsZSA9IG51bGwsIGNvbmZ1c2VkID0gbnVsbDtcblxuICBjb25zdCBzdG9wQWxsRmFjZSA9ICgpID0+IHsgaWYgKHNtaWxlKSBzbWlsZS5zdG9wKCk7IGlmIChjb25mdXNlZCkgY29uZnVzZWQuc3RvcCgpOyB9O1xuICBmdW5jdGlvbiBwaWNrQW5pbWF0aW9ucygpIHtcbiAgICBhbGxHcm91cHMgPSBzY2VuZS5hbmltYXRpb25Hcm91cHMgfHwgW107XG4gICAgY29uc3QgbGMgPSBzID0+IChzIHx8IFwiXCIpLnRvTG93ZXJDYXNlKCk7XG4gICAgY29uc3QgYnlOYW1lID0ga2V5ID0+IGFsbEdyb3Vwcy5maW5kKGcgPT4gbGMoZy5uYW1lKS5pbmNsdWRlcyhrZXkpKTtcblxuICAgIHdhbGsgPSBieU5hbWUoXCJ3YWxrXCIpIHx8IG51bGw7XG4gICAgc21pbGUgPSBieU5hbWUoXCJzbWlsZVwiKSB8fCBudWxsO1xuICAgIGNvbmZ1c2VkID0gYnlOYW1lKFwiY29uZnVzZVwiKSB8fCBudWxsO1xuICB9XG5cbiAgZnVuY3Rpb24gdG9nZ2xlV2FsaygpIHtcbiAgICBpZiAoIXdhbGspIHJldHVybjtcbiAgICBpZiAod2Fsay5pc1BsYXlpbmcpIHdhbGsuc3RvcCgpO1xuICAgIGVsc2UgeyB3YWxrLnJlc2V0KCk7IHdhbGsuc3RhcnQodHJ1ZSwgMS4wKTsgfVxuICB9XG4gIGZ1bmN0aW9uIHBsYXlTbWlsZSgpIHsgc3RvcEFsbEZhY2UoKTsgaWYgKHNtaWxlKSB7IHNtaWxlLnJlc2V0KCk7IHNtaWxlLnN0YXJ0KHRydWUsIDEuMCk7IH0gfVxuICBmdW5jdGlvbiBwbGF5Q29uZnVzZWQoKSB7IHN0b3BBbGxGYWNlKCk7IGlmIChjb25mdXNlZCkgeyBjb25mdXNlZC5yZXNldCgpOyBjb25mdXNlZC5zdGFydCh0cnVlLCAxLjApOyB9IH1cblxuICBmaWxlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCBhc3luYyAoZXYpID0+IHtcbiAgICBjb25zdCBmaWxlID0gZXYudGFyZ2V0LmZpbGVzPy5bMF07XG4gICAgaWYgKCFmaWxlKSByZXR1cm47XG5cbiAgICBzY2VuZS5tZXNoZXMuZmlsdGVyKG0gPT4gbSAhPT0gZ3JvdW5kKS5mb3JFYWNoKG0gPT4gbS5kaXNwb3NlKCkpO1xuICAgIHNjZW5lLmFuaW1hdGlvbkdyb3Vwcy5zbGljZSgpLmZvckVhY2goZyA9PiBnLmRpc3Bvc2UoKSk7XG4gICAgd2FsayA9IHNtaWxlID0gY29uZnVzZWQgPSBudWxsOyBhbGxHcm91cHMgPSBbXTsgY3VycmVudFJvb3QgPSBudWxsO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBCQUJZTE9OLlNjZW5lTG9hZGVyLkFwcGVuZEFzeW5jKFwiZmlsZTpcIiwgZmlsZSwgc2NlbmUpO1xuICAgICAgY3VycmVudFJvb3QgPSByZXN1bHQubWVzaGVzLmZpbmQobSA9PiBtICYmIG0ubmFtZSAmJiBtICE9PSBncm91bmQpIHx8IHJlc3VsdC5tZXNoZXNbMF07XG4gICAgICBpZiAoY3VycmVudFJvb3Q/LnNjYWxpbmcpIGN1cnJlbnRSb290LnNjYWxpbmcuc2V0QWxsKDAuMik7XG5cbiAgICAgIHBpY2tBbmltYXRpb25zKCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgY29uc29sZS5lcnJvcihcIkxvYWQgZXJyb3I6XCIsIGUpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICBmaWxlSW5wdXQudmFsdWUgPSBcIlwiO1xuICAgIH1cbiAgfSk7XG5cbiAgY29uc3QgY3RybHMgPSB7IGxlZnQ6IG51bGwsIHJpZ2h0OiBudWxsIH07XG4gIHhyLmlucHV0Lm9uQ29udHJvbGxlckFkZGVkT2JzZXJ2YWJsZS5hZGQoYyA9PiB7IGNvbnN0IGggPSBjLmlucHV0U291cmNlPy5oYW5kZWRuZXNzOyBpZiAoaCkgY3RybHNbaF0gPSBjOyB9KTtcbiAgeHIuaW5wdXQub25Db250cm9sbGVyUmVtb3ZlZE9ic2VydmFibGUuYWRkKGMgPT4geyBjb25zdCBoID0gYy5pbnB1dFNvdXJjZT8uaGFuZGVkbmVzczsgaWYgKGggJiYgY3RybHNbaF0gPT09IGMpIGN0cmxzW2hdID0gbnVsbDsgfSk7XG5cbiAgbGV0IHByZXYgPSB7IEE6IGZhbHNlLCBYOiBmYWxzZSwgWTogZmFsc2UgfTtcbiAgZnVuY3Rpb24gYW55UHJlc3NlZChjdHJsLCBpZHhzKSB7XG4gICAgaWYgKCFjdHJsPy5pbnB1dFNvdXJjZT8uZ2FtZXBhZCkgcmV0dXJuIGZhbHNlO1xuICAgIGNvbnN0IGJzID0gY3RybC5pbnB1dFNvdXJjZS5nYW1lcGFkLmJ1dHRvbnMgfHwgW107XG4gICAgZm9yIChjb25zdCBpIG9mIGlkeHMpIHsgY29uc3QgYiA9IGJzW2ldOyBpZiAoYiAmJiBiLnByZXNzZWQpIHJldHVybiB0cnVlOyB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIHNjZW5lLm9uQmVmb3JlUmVuZGVyT2JzZXJ2YWJsZS5hZGQoKCkgPT4ge1xuICAgIGNvbnN0IEEgPSBhbnlQcmVzc2VkKGN0cmxzLnJpZ2h0LCBbMCwxLDIsMyw0LDVdKTtcbiAgICBjb25zdCBYID0gYW55UHJlc3NlZChjdHJscy5sZWZ0LCAgWzAsMyw0LDUsMSwyXSk7XG4gICAgY29uc3QgWSA9IGFueVByZXNzZWQoY3RybHMubGVmdCwgIFsxLDQsNSwzLDAsMl0pO1xuICAgIGlmIChBICYmICFwcmV2LkEpIHRvZ2dsZVdhbGsoKTtcbiAgICBpZiAoWCAmJiAhcHJldi5YKSBwbGF5U21pbGUoKTtcbiAgICBpZiAoWSAmJiAhcHJldi5ZKSBwbGF5Q29uZnVzZWQoKTtcbiAgICBwcmV2ID0geyBBLCBYLCBZIH07XG4gIH0pO1xuXG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAoZSkgPT4ge1xuICAgIGNvbnN0IGsgPSBlLmtleS50b0xvd2VyQ2FzZSgpO1xuICAgIGlmIChrID09PSBcImFcIikgdG9nZ2xlV2FsaygpO1xuICAgIGlmIChrID09PSBcInhcIikgcGxheVNtaWxlKCk7XG4gICAgaWYgKGsgPT09IFwieVwiKSBwbGF5Q29uZnVzZWQoKTtcbiAgfSk7XG5cbiAgZW5naW5lLnJ1blJlbmRlckxvb3AoKCkgPT4gc2NlbmUucmVuZGVyKCkpO1xuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCAoKSA9PiBlbmdpbmUucmVzaXplKCkpO1xuICByZXR1cm4gc2NlbmU7XG59O1xuXG4vLyMgc291cmNlVVJMPWZpbGU6Ly8vcGcvaW5kZXguanMiXSwKICAibWFwcGluZ3MiOiAiO0FBQU8sSUFBTSxjQUFjLGlCQUFrQjtBQUMzQyxRQUFNLFNBQVMsU0FBUyxlQUFlLGNBQWM7QUFDckQsUUFBTSxTQUFTLElBQUksUUFBUSxPQUFPLFFBQVEsTUFBTSxFQUFFLHVCQUF1QixNQUFNLFNBQVMsS0FBSyxDQUFDO0FBQzlGLFFBQU0sUUFBUSxJQUFJLFFBQVEsTUFBTSxNQUFNO0FBRXRDLE1BQUksUUFBUSxpQkFBaUIsUUFBUSxJQUFJLFFBQVEsUUFBUSxHQUFHLEdBQUcsQ0FBQyxHQUFHLEtBQUs7QUFDeEUsUUFBTSxTQUFTLFFBQVEsWUFBWSxhQUFhLFVBQVUsRUFBRSxPQUFPLElBQUksUUFBUSxHQUFHLEdBQUcsS0FBSztBQUMx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\n";
    const blob = new Blob([code], { type: 'text/javascript' });
    const url = URL.createObjectURL(blob);

    const BABYLON = window.BABYLON;
    const canvas = document.getElementById('renderCanvas');

    // Import your bundled app (which exports createScene / default)
    const mod = await import(url);

    let engine = null;
    if (typeof mod.createEngine === 'function') {
      try { engine = await mod.createEngine(); } catch {}
    }
    if (!engine) {
      engine = new BABYLON.Engine(canvas, true, { preserveDrawingBuffer: true, stencil: true });
    }
    window.engine = engine; window.canvas = canvas;

    let createScene = mod.createScene || mod.default;
    if (!createScene && mod.Playground?.CreateScene) createScene = (e,c)=>mod.Playground.CreateScene(e,c);
    if (!createScene) throw new Error('No createScene() export found.');

    const scene = await (createScene(engine, canvas) ?? createScene());
    engine.runRenderLoop(()=>scene.render());
    addEventListener('resize', ()=>engine.resize());

    addEventListener('unload', ()=> URL.revokeObjectURL(url));
  </script>
</body>
</html>